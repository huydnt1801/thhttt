import jwt from "jsonwebtoken"

const publicKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoVoq+G3T1gHwt+YIOvz19giGnUy4shOSm1a1Dsu4kZ5EBTNqQbWVI3+dN2RNlOlE0YdB3BroCfRFDeltJJZCekFTw6HqEiCaw+UOToAByGXB7NMzGpoe8pp/EF/2EDEEc174wMT0nfJqEcE5r2R0LTsigDZ00JvcEGEfsApf+KJq7vzKzRQ327Zdkv9VpOCVlB1MxBhRtb/EKWG7cahR2yYIqw8GeRrInB8k4xVKkkLTYwwSpkT451tW5tJTHoIaWM8DyEfz3Ps84o/sYKju3l/tfGIX1fMQKOoW4pcaJvJdPEIDOSfqtyrFsT9PN05RI5uUMczV6fZdIqDacy2O6QIDAQAB
-----END PUBLIC KEY-----`;

const verifyAccessToken = (token) => {
    try {
        const data = jwt.verify(token, publicKey, { algorithms: "RS256" });
        return { data: data };
    } catch (error) {
        console.log(error);
        return { error: { name: error.name, message: error.message } };
    }
};

const token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBTEFYbDNFVzk2bGNFbktBX09WX3NrVjB6eXdkNEVHSGpYaXlyRlZkLW1vIn0.eyJleHAiOjE3MDE2NzE4MTcsImlhdCI6MTcwMTY2ODIxNywiYXV0aF90aW1lIjoxNzAxNjY1MTAyLCJqdGkiOiI0NmMzM2JjNS00MzBjLTQ1MTUtOGFjZS00YTY1OTQyN2RlMzEiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL3NzbyIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiI4MmFmODdjYS1iNTFiLTQ1YTctYTVmZC0zZjQyMjgwMzJmMmYiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJiYW4taGFuZyIsIm5vbmNlIjoiZWRiMDYyNTctMmFhYy00Mjg3LThiZGQtZmM5OGY4MzMwODI0Iiwic2Vzc2lvbl9zdGF0ZSI6Ijk0Mzk4OTk1LTA4YTAtNDRkYi1iZmFlLTg5MjA1NGQyZTRmOSIsImFjciI6IjAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2xvY2FsaG9zdDozMDAwIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsImRlZmF1bHQtcm9sZXMtc3NvIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwic2lkIjoiOTQzOTg5OTUtMDhhMC00NGRiLWJmYWUtODkyMDU0ZDJlNGY5IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiVHLGsMahbmcgUXVhbmcgUGjDuiIsInByZWZlcnJlZF91c2VybmFtZSI6InBodWxlIiwiZ2l2ZW5fbmFtZSI6IlRyxrDGoW5nIiwiZmFtaWx5X25hbWUiOiJRdWFuZyBQaMO6IiwiZW1haWwiOiJwaHVsZUBnbWFpbC5jb20ifQ.kA6fILN0pXIiYwudaGr4Z8WJKZ4oIfDHBcBX1Txc2TRklqY_6iCfQtUecbD_a3uB1cLwPUWJwGmp9mQLDYCgW4c6LYWi8N5Z8Kbs8IyS2trMxwxNk2YRDLw976Wlv6BAnu0ZCf3GLXWmmr44mFbttQi90e-J-KSlZKYaNS5uKLKcP1S9L1o4KWrUZnxKPodKy1gPUs8tedC7e7fcLj9_SBzW9aHAqegE8jQVf2SKseJdI-7-EyaQaV99a-ukBizgXugHk4aGxvmCdofbuwgClChNzuwzpqEFy3sGqnTcowFkxx6obrmhAQ3kUyoiel7_r-B9Q0n6z1x1Ga-VWdXt6Q"

console.log(verifyAccessToken(token));